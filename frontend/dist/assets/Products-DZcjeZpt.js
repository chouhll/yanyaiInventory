import{_ as S,r as c,o as T,d as h,h as l,w as o,i as n,y as b,E as s,v as K,j as k,s as j,x as z,m as i,t as C,e as x,C as F}from"./index-_DMjZfO8.js";const I={class:"products-page"},G={class:"card-header"},H={__name:"Products",setup(J){const g=c([]),f=c(!1),p=c(!1),_=c(!1),a=c({inventoryCode:"",name:"",specification:"",category:"",unit:"",sku:"",price:0,stock:0}),y=async()=>{f.value=!0;try{g.value=await b.getAll()}catch{s.error("加载产品列表失败")}finally{f.value=!1}},U=async()=>{if(!a.value.inventoryCode||!a.value.name){s.warning("请填写必填项");return}_.value=!0;try{await b.create(a.value),s.success("添加成功"),p.value=!1,a.value={inventoryCode:"",name:"",specification:"",category:"",unit:"",sku:"",price:0,stock:0},y()}catch{s.error("添加失败")}finally{_.value=!1}},B=async m=>{try{await F.confirm(`确定要删除产品"${m.name}"吗？此操作不可撤销。`,"删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await b.delete(m.id),s.success("删除成功"),y()}catch(e){e!=="cancel"&&s.error("删除失败")}};return T(()=>{y()}),(m,e)=>{const D=n("Plus"),P=n("el-icon"),v=n("el-button"),u=n("el-table-column"),q=n("el-tag"),A=n("el-table"),E=n("el-card"),r=n("el-input"),d=n("el-form-item"),w=n("el-input-number"),$=n("el-form"),M=n("el-dialog"),N=K("loading");return k(),h("div",I,[l(E,{shadow:"hover"},{header:o(()=>[x("div",G,[e[12]||(e[12]=x("span",null,"产品列表",-1)),l(v,{type:"primary",onClick:e[0]||(e[0]=t=>p.value=!0)},{default:o(()=>[l(P,null,{default:o(()=>[l(D)]),_:1}),e[11]||(e[11]=i(" 添加产品 ",-1))]),_:1})])]),default:o(()=>[j((k(),z(A,{data:g.value,style:{width:"100%"}},{default:o(()=>[l(u,{prop:"inventoryCode",label:"库存编码",width:"120"}),l(u,{prop:"name",label:"产品名称",width:"180"}),l(u,{prop:"specification",label:"规格型号",width:"150"}),l(u,{prop:"category",label:"分类",width:"120"}),l(u,{prop:"unit",label:"单位",width:"80"}),l(u,{prop:"stock",label:"库存",width:"100"},{default:o(({row:t})=>[l(q,{type:t.stock>10?"success":"warning"},{default:o(()=>[i(C(t.stock),1)]),_:2},1032,["type"])]),_:1}),l(u,{prop:"price",label:"价格",width:"120"},{default:o(({row:t})=>{var V;return[i(" ¥"+C(((V=t.price)==null?void 0:V.toFixed(2))||"0.00"),1)]}),_:1}),l(u,{label:"操作",width:"100",fixed:"right"},{default:o(({row:t})=>[l(v,{type:"danger",size:"small",onClick:V=>B(t)},{default:o(()=>[...e[13]||(e[13]=[i(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[N,f.value]])]),_:1}),l(M,{modelValue:p.value,"onUpdate:modelValue":e[10]||(e[10]=t=>p.value=t),title:"添加产品",width:"600px"},{footer:o(()=>[l(v,{onClick:e[9]||(e[9]=t=>p.value=!1)},{default:o(()=>[...e[14]||(e[14]=[i("取消",-1)])]),_:1}),l(v,{type:"primary",onClick:U,loading:_.value},{default:o(()=>[...e[15]||(e[15]=[i("确定",-1)])]),_:1},8,["loading"])]),default:o(()=>[l($,{model:a.value,"label-width":"100px"},{default:o(()=>[l(d,{label:"库存编码",required:""},{default:o(()=>[l(r,{modelValue:a.value.inventoryCode,"onUpdate:modelValue":e[1]||(e[1]=t=>a.value.inventoryCode=t),placeholder:"请输入库存编码"},null,8,["modelValue"])]),_:1}),l(d,{label:"产品名称",required:""},{default:o(()=>[l(r,{modelValue:a.value.name,"onUpdate:modelValue":e[2]||(e[2]=t=>a.value.name=t),placeholder:"请输入产品名称"},null,8,["modelValue"])]),_:1}),l(d,{label:"规格型号"},{default:o(()=>[l(r,{modelValue:a.value.specification,"onUpdate:modelValue":e[3]||(e[3]=t=>a.value.specification=t),placeholder:"请输入规格型号"},null,8,["modelValue"])]),_:1}),l(d,{label:"产品分类"},{default:o(()=>[l(r,{modelValue:a.value.category,"onUpdate:modelValue":e[4]||(e[4]=t=>a.value.category=t),placeholder:"请输入产品分类"},null,8,["modelValue"])]),_:1}),l(d,{label:"计量单位"},{default:o(()=>[l(r,{modelValue:a.value.unit,"onUpdate:modelValue":e[5]||(e[5]=t=>a.value.unit=t),placeholder:"如：个、箱、吨"},null,8,["modelValue"])]),_:1}),l(d,{label:"SKU"},{default:o(()=>[l(r,{modelValue:a.value.sku,"onUpdate:modelValue":e[6]||(e[6]=t=>a.value.sku=t),placeholder:"请输入SKU"},null,8,["modelValue"])]),_:1}),l(d,{label:"价格",required:""},{default:o(()=>[l(w,{modelValue:a.value.price,"onUpdate:modelValue":e[7]||(e[7]=t=>a.value.price=t),precision:2,min:0},null,8,["modelValue"])]),_:1}),l(d,{label:"库存数量",required:""},{default:o(()=>[l(w,{modelValue:a.value.stock,"onUpdate:modelValue":e[8]||(e[8]=t=>a.value.stock=t),min:0},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},O=S(H,[["__scopeId","data-v-e575b7b0"]]);export{O as default};
