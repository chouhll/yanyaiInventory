import{_ as S,r as i,o as F,d as A,h as l,w as t,i as m,I as c,E as r,v as G,j as x,s as H,x as J,e as y,t as B,m as s,C as K}from"./index-CX8ur3in.js";const L={class:"customers-page"},O={class:"card-header"},Q={key:0,class:"invoice-info"},R={class:"info-detail"},W={key:1,class:"text-muted"},X={__name:"Customers",setup(Y){const U=i([]),_=i(!1),V=i(!1),b=i(!1),v=i(!1),g=i(null),o=i({name:"",email:"",phone:"",address:"",taxNumber:"",companyName:"",companyAddress:"",bankName:"",bankAccount:""}),N=async()=>{_.value=!0;try{U.value=await c.getAll()}catch{r.error("加载客户列表失败")}finally{_.value=!1}},D=async()=>{if(!o.value.name){r.warning("请填写客户名称");return}v.value=!0;try{await c.create(o.value),r.success("添加成功"),V.value=!1,o.value={name:"",email:"",phone:"",address:"",taxNumber:"",companyName:"",companyAddress:"",bankName:"",bankAccount:""},N()}catch{r.error("添加失败")}finally{v.value=!1}},E=u=>{g.value=u.id,o.value={name:u.name||"",email:u.email||"",phone:u.phone||"",address:u.address||"",taxNumber:u.taxNumber||"",companyName:u.companyName||"",companyAddress:u.companyAddress||"",bankName:u.bankName||"",bankAccount:u.bankAccount||""},b.value=!0},$=async()=>{if(!o.value.name){r.warning("请填写客户名称");return}v.value=!0;try{await c.update(g.value,o.value),r.success("更新成功"),b.value=!1,o.value={name:"",email:"",phone:"",address:"",taxNumber:"",companyName:"",companyAddress:"",bankName:"",bankAccount:""},g.value=null,N()}catch{r.error("更新失败")}finally{v.value=!1}},I=async u=>{try{await K.confirm(`确定要删除客户"${u.name}"吗？此操作不可撤销。`,"删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await c.delete(u.id),r.success("删除成功"),N()}catch(e){e!=="cancel"&&r.error("删除失败")}};return F(()=>{N()}),(u,e)=>{const M=m("Plus"),T=m("el-icon"),p=m("el-button"),f=m("el-table-column"),q=m("el-table"),z=m("el-card"),k=m("el-divider"),n=m("el-input"),d=m("el-form-item"),w=m("el-form"),C=m("el-dialog"),P=G("loading");return x(),A("div",L,[l(z,{shadow:"hover"},{header:t(()=>[y("div",O,[e[24]||(e[24]=y("span",null,"客户列表",-1)),l(p,{type:"primary",onClick:e[0]||(e[0]=a=>V.value=!0)},{default:t(()=>[l(T,null,{default:t(()=>[l(M)]),_:1}),e[23]||(e[23]=s(" 添加客户 ",-1))]),_:1})])]),default:t(()=>[H((x(),J(q,{data:U.value,style:{width:"100%"}},{default:t(()=>[l(f,{prop:"id",label:"客户编号",width:"100"}),l(f,{prop:"name",label:"客户名称",width:"150"}),l(f,{prop:"phone",label:"电话",width:"130"}),l(f,{prop:"email",label:"邮箱",width:"200"}),l(f,{label:"开票信息","min-width":"250"},{default:t(({row:a})=>[a.companyName?(x(),A("div",Q,[y("div",null,[y("strong",null,B(a.companyName),1)]),y("div",R,"税号: "+B(a.taxNumber||"-"),1)])):(x(),A("span",W,"未填写"))]),_:1}),l(f,{label:"操作",width:"180",fixed:"right"},{default:t(({row:a})=>[l(p,{type:"primary",size:"small",onClick:j=>E(a)},{default:t(()=>[...e[25]||(e[25]=[s(" 编辑 ",-1)])]),_:1},8,["onClick"]),l(p,{type:"danger",size:"small",onClick:j=>I(a)},{default:t(()=>[...e[26]||(e[26]=[s(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[P,_.value]])]),_:1}),l(C,{modelValue:V.value,"onUpdate:modelValue":e[11]||(e[11]=a=>V.value=a),title:"添加客户",width:"700px"},{footer:t(()=>[l(p,{onClick:e[10]||(e[10]=a=>V.value=!1)},{default:t(()=>[...e[29]||(e[29]=[s("取消",-1)])]),_:1}),l(p,{type:"primary",onClick:D,loading:v.value},{default:t(()=>[...e[30]||(e[30]=[s("确定",-1)])]),_:1},8,["loading"])]),default:t(()=>[l(w,{model:o.value,"label-width":"120px"},{default:t(()=>[l(k,{"content-position":"left"},{default:t(()=>[...e[27]||(e[27]=[s("基本信息",-1)])]),_:1}),l(d,{label:"客户名称",required:""},{default:t(()=>[l(n,{modelValue:o.value.name,"onUpdate:modelValue":e[1]||(e[1]=a=>o.value.name=a),placeholder:"请输入客户名称"},null,8,["modelValue"])]),_:1}),l(d,{label:"联系电话"},{default:t(()=>[l(n,{modelValue:o.value.phone,"onUpdate:modelValue":e[2]||(e[2]=a=>o.value.phone=a),placeholder:"请输入电话"},null,8,["modelValue"])]),_:1}),l(d,{label:"邮箱"},{default:t(()=>[l(n,{modelValue:o.value.email,"onUpdate:modelValue":e[3]||(e[3]=a=>o.value.email=a),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1}),l(d,{label:"联系地址"},{default:t(()=>[l(n,{modelValue:o.value.address,"onUpdate:modelValue":e[4]||(e[4]=a=>o.value.address=a),type:"textarea",rows:2,placeholder:"请输入联系地址"},null,8,["modelValue"])]),_:1}),l(k,{"content-position":"left"},{default:t(()=>[...e[28]||(e[28]=[s("开票信息",-1)])]),_:1}),l(d,{label:"公司抬头"},{default:t(()=>[l(n,{modelValue:o.value.companyName,"onUpdate:modelValue":e[5]||(e[5]=a=>o.value.companyName=a),placeholder:"请输入公司抬头"},null,8,["modelValue"])]),_:1}),l(d,{label:"税号"},{default:t(()=>[l(n,{modelValue:o.value.taxNumber,"onUpdate:modelValue":e[6]||(e[6]=a=>o.value.taxNumber=a),placeholder:"请输入税号"},null,8,["modelValue"])]),_:1}),l(d,{label:"公司地址"},{default:t(()=>[l(n,{modelValue:o.value.companyAddress,"onUpdate:modelValue":e[7]||(e[7]=a=>o.value.companyAddress=a),type:"textarea",rows:2,placeholder:"请输入公司地址"},null,8,["modelValue"])]),_:1}),l(d,{label:"开户银行"},{default:t(()=>[l(n,{modelValue:o.value.bankName,"onUpdate:modelValue":e[8]||(e[8]=a=>o.value.bankName=a),placeholder:"请输入开户银行"},null,8,["modelValue"])]),_:1}),l(d,{label:"银行账号"},{default:t(()=>[l(n,{modelValue:o.value.bankAccount,"onUpdate:modelValue":e[9]||(e[9]=a=>o.value.bankAccount=a),placeholder:"请输入银行账号"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(C,{modelValue:b.value,"onUpdate:modelValue":e[22]||(e[22]=a=>b.value=a),title:"编辑客户",width:"700px"},{footer:t(()=>[l(p,{onClick:e[21]||(e[21]=a=>b.value=!1)},{default:t(()=>[...e[33]||(e[33]=[s("取消",-1)])]),_:1}),l(p,{type:"primary",onClick:$,loading:v.value},{default:t(()=>[...e[34]||(e[34]=[s("保存",-1)])]),_:1},8,["loading"])]),default:t(()=>[l(w,{model:o.value,"label-width":"120px"},{default:t(()=>[l(k,{"content-position":"left"},{default:t(()=>[...e[31]||(e[31]=[s("基本信息",-1)])]),_:1}),l(d,{label:"客户名称",required:""},{default:t(()=>[l(n,{modelValue:o.value.name,"onUpdate:modelValue":e[12]||(e[12]=a=>o.value.name=a),placeholder:"请输入客户名称"},null,8,["modelValue"])]),_:1}),l(d,{label:"联系电话"},{default:t(()=>[l(n,{modelValue:o.value.phone,"onUpdate:modelValue":e[13]||(e[13]=a=>o.value.phone=a),placeholder:"请输入电话"},null,8,["modelValue"])]),_:1}),l(d,{label:"邮箱"},{default:t(()=>[l(n,{modelValue:o.value.email,"onUpdate:modelValue":e[14]||(e[14]=a=>o.value.email=a),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1}),l(d,{label:"联系地址"},{default:t(()=>[l(n,{modelValue:o.value.address,"onUpdate:modelValue":e[15]||(e[15]=a=>o.value.address=a),type:"textarea",rows:2,placeholder:"请输入联系地址"},null,8,["modelValue"])]),_:1}),l(k,{"content-position":"left"},{default:t(()=>[...e[32]||(e[32]=[s("开票信息",-1)])]),_:1}),l(d,{label:"公司抬头"},{default:t(()=>[l(n,{modelValue:o.value.companyName,"onUpdate:modelValue":e[16]||(e[16]=a=>o.value.companyName=a),placeholder:"请输入公司抬头"},null,8,["modelValue"])]),_:1}),l(d,{label:"税号"},{default:t(()=>[l(n,{modelValue:o.value.taxNumber,"onUpdate:modelValue":e[17]||(e[17]=a=>o.value.taxNumber=a),placeholder:"请输入税号"},null,8,["modelValue"])]),_:1}),l(d,{label:"公司地址"},{default:t(()=>[l(n,{modelValue:o.value.companyAddress,"onUpdate:modelValue":e[18]||(e[18]=a=>o.value.companyAddress=a),type:"textarea",rows:2,placeholder:"请输入公司地址"},null,8,["modelValue"])]),_:1}),l(d,{label:"开户银行"},{default:t(()=>[l(n,{modelValue:o.value.bankName,"onUpdate:modelValue":e[19]||(e[19]=a=>o.value.bankName=a),placeholder:"请输入开户银行"},null,8,["modelValue"])]),_:1}),l(d,{label:"银行账号"},{default:t(()=>[l(n,{modelValue:o.value.bankAccount,"onUpdate:modelValue":e[20]||(e[20]=a=>o.value.bankAccount=a),placeholder:"请输入银行账号"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},h=S(X,[["__scopeId","data-v-ea423410"]]);export{h as default};
