import{_ as Y,r as b,o as U,d as y,h as a,s as j,w as e,i as u,v as H,x as W,y as q,z as G,E as J,j as g,m as r,f as T,t as o,e as s,A,F as K,B as Q}from"./index-_DMjZfO8.js";const X={class:"dashboard-page"},Z={key:0},tt={class:"stat-content"},st={class:"stat-value"},et={class:"stat-detail"},at={class:"stat-content"},lt={class:"stat-value"},ot={class:"stat-detail"},dt={class:"stat-content"},nt={class:"stat-value"},it={class:"stat-content"},rt={class:"stat-value"},ut={class:"stat-detail"},ct={class:"detail-stats"},vt={class:"stat-item"},pt={class:"value"},_t={class:"stat-item"},mt={class:"value"},ft={class:"stat-item"},gt={class:"value"},ht={class:"stat-item"},yt={class:"value"},Dt={class:"stat-item"},wt={class:"value"},bt={class:"detail-stats"},xt={class:"stat-item highlight"},Ct={class:"value success"},kt={class:"stat-item"},Pt={class:"value"},St={class:"stat-item highlight"},Et={class:"stat-item"},It={class:"value"},Ot={class:"status-stats"},Tt={class:"status-count"},At={key:0,class:"empty-hint"},Mt={class:"card-header"},Nt={class:"card-header"},Bt={__name:"Dashboard",setup(Ft){const x=b(!1),p=b([]),C=b([]),d=b({totalProducts:0,totalCustomers:0,totalOrders:0,totalPurchases:0,periodOrders:0,periodPurchases:0,periodInvoices:0,salesRevenue:0,purchaseCost:0,grossProfit:0,grossMargin:0,invoicedAmount:0,taxAmount:0,pendingPayment:0,ordersByStatus:{},recentOrders:[],startDate:"",endDate:""}),D=async()=>{x.value=!0;try{let l,t;p.value&&p.value.length===2&&(l=p.value[0],t=p.value[1]);const h=await G.getDashboard(l,t);d.value=h}catch(l){J.error("åŠ è½½ç»Ÿè®¡æ•°æ®å¤±è´¥"),console.error(l)}finally{x.value=!1}},M=async()=>{try{const l=await q.getAll();C.value=l.slice(0,5)}catch{console.error("åŠ è½½äº§å“å¤±è´¥")}},m=l=>l?parseFloat(l).toFixed(2):"0.00",k=l=>l?parseFloat(l).toFixed(2):"0.00",N=l=>l?new Date(l).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-",B=l=>!l||!l.items?"0.00":l.items.reduce((h,i)=>h+(i.subtotal||0),0).toFixed(2),P=l=>({CREATED:"info",UNPAID:"warning",PAID:"success",INVOICED:"primary",SHIPPED:"",COMPLETED:"success",CANCELLED:"danger"})[l]||"info",S=l=>({CREATED:"å·²åˆ›å»º",UNPAID:"æœªä»˜æ¬¾",PAID:"å·²ä»˜æ¬¾",INVOICED:"å·²å¼€ç¥¨",SHIPPED:"å·²å‘è´§",COMPLETED:"å·²å®Œæˆ",CANCELLED:"å·²å–æ¶ˆ"})[l]||l,F=()=>{const t=new Date().toISOString().split("T")[0];p.value=[t,t],D()},V=()=>{const l=new Date,t=new Date(l);t.setDate(l.getDate()-l.getDay()),p.value=[t.toISOString().split("T")[0],l.toISOString().split("T")[0]],D()},E=()=>{const l=new Date,t=new Date(l.getFullYear(),l.getMonth(),1);p.value=[t.toISOString().split("T")[0],l.toISOString().split("T")[0]],D()};return U(()=>{E(),M()}),(l,t)=>{const h=u("el-date-picker"),i=u("el-col"),L=u("Refresh"),R=u("el-icon"),f=u("el-button"),w=u("el-row"),c=u("el-card"),$=u("el-divider"),I=u("el-tag"),_=u("el-table-column"),O=u("el-table"),z=H("loading");return g(),y("div",X,[a(c,{shadow:"never",class:"filter-card"},{default:e(()=>[a(w,{gutter:15,align:"middle"},{default:e(()=>[a(i,{xs:24,sm:24,md:10},{default:e(()=>[a(h,{modelValue:p.value,"onUpdate:modelValue":t[0]||(t[0]=n=>p.value=n),type:"daterange","range-separator":"è‡³","start-placeholder":"å¼€å§‹æ—¥æœŸ","end-placeholder":"ç»“æŸæ—¥æœŸ","value-format":"YYYY-MM-DD",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(i,{xs:24,sm:24,md:8},{default:e(()=>[a(f,{type:"primary",onClick:D},{default:e(()=>[a(R,null,{default:e(()=>[a(L)]),_:1}),t[3]||(t[3]=r(" åˆ·æ–°æ•°æ® ",-1))]),_:1}),a(f,{onClick:F},{default:e(()=>[...t[4]||(t[4]=[r("ä»Šå¤©",-1)])]),_:1}),a(f,{onClick:V},{default:e(()=>[...t[5]||(t[5]=[r("æœ¬å‘¨",-1)])]),_:1}),a(f,{onClick:E},{default:e(()=>[...t[6]||(t[6]=[r("æœ¬æœˆ",-1)])]),_:1})]),_:1}),a(i,{xs:24,sm:24,md:6,style:{"text-align":"right",color:"#909399","font-size":"13px"}},{default:e(()=>[d.value.startDate?(g(),y("span",Z,o(d.value.startDate)+" ~ "+o(d.value.endDate),1)):T("",!0)]),_:1})]),_:1})]),_:1}),j((g(),W(w,{gutter:20,style:{"margin-top":"20px"}},{default:e(()=>[a(i,{xs:24,sm:12,md:6},{default:e(()=>[a(c,{shadow:"hover",class:"stat-card revenue-card"},{default:e(()=>[t[8]||(t[8]=s("div",{class:"stat-icon"},"ðŸ’°",-1)),s("div",tt,[t[7]||(t[7]=s("div",{class:"stat-label"},"é”€å”®æ”¶å…¥",-1)),s("div",st,"Â¥"+o(m(d.value.salesRevenue)),1),s("div",et,"æœŸé—´è®¢å•: "+o(d.value.periodOrders||0),1)])]),_:1})]),_:1}),a(i,{xs:24,sm:12,md:6},{default:e(()=>[a(c,{shadow:"hover",class:"stat-card profit-card"},{default:e(()=>[t[10]||(t[10]=s("div",{class:"stat-icon"},"ðŸ“ˆ",-1)),s("div",at,[t[9]||(t[9]=s("div",{class:"stat-label"},"æ¯›åˆ©æ¶¦",-1)),s("div",lt,"Â¥"+o(m(d.value.grossProfit)),1),s("div",ot,"æ¯›åˆ©çŽ‡: "+o(k(d.value.grossMargin))+"%",1)])]),_:1})]),_:1}),a(i,{xs:24,sm:12,md:6},{default:e(()=>[a(c,{shadow:"hover",class:"stat-card pending-card"},{default:e(()=>[t[13]||(t[13]=s("div",{class:"stat-icon"},"â°",-1)),s("div",dt,[t[11]||(t[11]=s("div",{class:"stat-label"},"å¾…æ”¶æ¬¾",-1)),s("div",nt,"Â¥"+o(m(d.value.pendingPayment)),1),t[12]||(t[12]=s("div",{class:"stat-detail"},"éœ€è·Ÿè¿›æ”¶æ¬¾",-1))])]),_:1})]),_:1}),a(i,{xs:24,sm:12,md:6},{default:e(()=>[a(c,{shadow:"hover",class:"stat-card invoice-card"},{default:e(()=>[t[15]||(t[15]=s("div",{class:"stat-icon"},"ðŸ§¾",-1)),s("div",it,[t[14]||(t[14]=s("div",{class:"stat-label"},"å¼€ç¥¨é‡‘é¢",-1)),s("div",rt,"Â¥"+o(m(d.value.invoicedAmount)),1),s("div",ut,"ç¨Žé¢: Â¥"+o(m(d.value.taxAmount)),1)])]),_:1})]),_:1})]),_:1})),[[z,x.value]]),a(w,{gutter:20,style:{"margin-top":"20px"}},{default:e(()=>[a(i,{xs:24,sm:24,md:12},{default:e(()=>[a(c,{shadow:"hover"},{header:e(()=>[...t[16]||(t[16]=[s("div",{class:"card-header"},[s("span",{style:{"font-weight":"600"}},"ðŸ“Š ä¸šåŠ¡ç»Ÿè®¡")],-1)])]),default:e(()=>[s("div",ct,[s("div",vt,[t[17]||(t[17]=s("span",{class:"label"},"æœŸé—´è®¢å•æ•°",-1)),s("span",pt,o(d.value.periodOrders||0),1)]),s("div",_t,[t[18]||(t[18]=s("span",{class:"label"},"æœŸé—´é‡‡è´­æ•°",-1)),s("span",mt,o(d.value.periodPurchases||0),1)]),s("div",ft,[t[19]||(t[19]=s("span",{class:"label"},"æœŸé—´å‘ç¥¨æ•°",-1)),s("span",gt,o(d.value.periodInvoices||0),1)]),a($),s("div",ht,[t[20]||(t[20]=s("span",{class:"label"},"äº§å“æ€»æ•°",-1)),s("span",yt,o(d.value.totalProducts||0),1)]),s("div",Dt,[t[21]||(t[21]=s("span",{class:"label"},"å®¢æˆ·æ€»æ•°",-1)),s("span",wt,o(d.value.totalCustomers||0),1)])])]),_:1})]),_:1}),a(i,{xs:24,sm:24,md:12},{default:e(()=>[a(c,{shadow:"hover"},{header:e(()=>[...t[22]||(t[22]=[s("div",{class:"card-header"},[s("span",{style:{"font-weight":"600"}},"ðŸ’µ æˆæœ¬ä¸Žåˆ©æ¶¦")],-1)])]),default:e(()=>[s("div",bt,[s("div",xt,[t[23]||(t[23]=s("span",{class:"label"},"é”€å”®æ”¶å…¥",-1)),s("span",Ct,"Â¥"+o(m(d.value.salesRevenue)),1)]),s("div",kt,[t[24]||(t[24]=s("span",{class:"label"},"é‡‡è´­æˆæœ¬",-1)),s("span",Pt,"Â¥"+o(m(d.value.purchaseCost)),1)]),s("div",St,[t[25]||(t[25]=s("span",{class:"label"},"æ¯›åˆ©æ¶¦",-1)),s("span",{class:A(["value",d.value.grossProfit>=0?"success":"danger"])}," Â¥"+o(m(d.value.grossProfit)),3)]),s("div",Et,[t[26]||(t[26]=s("span",{class:"label"},"æ¯›åˆ©çŽ‡",-1)),s("span",It,o(k(d.value.grossMargin))+"%",1)])])]),_:1})]),_:1})]),_:1}),a(w,{gutter:20,style:{"margin-top":"20px"}},{default:e(()=>[a(i,{xs:24,sm:24,md:12},{default:e(()=>[a(c,{shadow:"hover"},{header:e(()=>[...t[27]||(t[27]=[s("div",{class:"card-header"},[s("span",{style:{"font-weight":"600"}},"ðŸ“‹ è®¢å•çŠ¶æ€åˆ†å¸ƒ")],-1)])]),default:e(()=>[s("div",Ot,[(g(!0),y(K,null,Q(d.value.ordersByStatus,(n,v)=>(g(),y("div",{key:v,class:"status-item"},[a(I,{type:P(v),size:"large"},{default:e(()=>[r(o(S(v)),1)]),_:2},1032,["type"]),s("span",Tt,o(n),1)]))),128)),!d.value.ordersByStatus||Object.keys(d.value.ordersByStatus).length===0?(g(),y("div",At," æœŸé—´å†…æ— è®¢å• ")):T("",!0)])]),_:1})]),_:1}),a(i,{xs:24,sm:24,md:12},{default:e(()=>[a(c,{shadow:"hover"},{header:e(()=>[s("div",Mt,[t[29]||(t[29]=s("span",{style:{"font-weight":"600"}},"ðŸ“¦ åº“å­˜å¿«è§ˆ",-1)),a(f,{type:"primary",link:"",onClick:t[1]||(t[1]=n=>l.$router.push("/products"))},{default:e(()=>[...t[28]||(t[28]=[r(" æŸ¥çœ‹è¯¦æƒ… ",-1)])]),_:1})])]),default:e(()=>[a(O,{data:C.value,style:{width:"100%"},size:"small"},{default:e(()=>[a(_,{prop:"name",label:"äº§å“åç§°","min-width":"120"}),a(_,{prop:"stock",label:"åº“å­˜",width:"80",align:"right"},{default:e(({row:n})=>[s("span",{class:A(n.stock<10?"low-stock":"")},o(n.stock||0),3)]),_:1}),a(_,{label:"å•ä»·",width:"100",align:"right"},{default:e(({row:n})=>{var v;return[r(" Â¥"+o(((v=n.price)==null?void 0:v.toFixed(2))||"0.00"),1)]}),_:1})]),_:1},8,["data"])]),_:1})]),_:1})]),_:1}),a(c,{shadow:"hover",style:{"margin-top":"20px"}},{header:e(()=>[s("div",Nt,[t[31]||(t[31]=s("span",{style:{"font-weight":"600"}},"ðŸ“ æœ€è¿‘è®¢å•",-1)),a(f,{type:"primary",link:"",onClick:t[2]||(t[2]=n=>l.$router.push("/orders"))},{default:e(()=>[...t[30]||(t[30]=[r(" æŸ¥çœ‹å…¨éƒ¨ ",-1)])]),_:1})])]),default:e(()=>[a(O,{data:d.value.recentOrders,style:{width:"100%"}},{default:e(()=>[a(_,{prop:"orderNumber",label:"è®¢å•å·",width:"180"}),a(_,{label:"å®¢æˆ·",width:"150"},{default:e(({row:n})=>{var v;return[r(o(((v=n.customer)==null?void 0:v.name)||"-"),1)]}),_:1}),a(_,{label:"è®¢å•æ—¥æœŸ",width:"180"},{default:e(({row:n})=>[r(o(N(n.orderDate)),1)]),_:1}),a(_,{label:"é‡‘é¢",width:"130",align:"right"},{default:e(({row:n})=>[r(" Â¥"+o(B(n)),1)]),_:1}),a(_,{label:"çŠ¶æ€",width:"110"},{default:e(({row:n})=>[a(I,{type:P(n.status)},{default:e(()=>[r(o(S(n.status)),1)]),_:2},1032,["type"])]),_:1}),a(_,{label:"æ“ä½œ",width:"100",fixed:"right"},{default:e(({row:n})=>[a(f,{type:"primary",link:"",onClick:v=>l.$router.push(`/orders/${n.id}`)},{default:e(()=>[...t[32]||(t[32]=[r(" è¯¦æƒ… ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})])}}},Lt=Y(Bt,[["__scopeId","data-v-c4489e4a"]]);export{Lt as default};
